<html>
    <head>
        <title>{{ track.name }} - Gypsum</title>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <script type="text/javascript">
          var map;
          
          $(document).ready(function() {
            var latlng = new google.maps.LatLng(57.8, 11.9);
            var myOptions = {
              zoom: 8,
              center: latlng,
              mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map"), myOptions);
            
            $.getJSON('positions', function(data) { drawTrack(data); });
          });
          
          function drawTrack(positions) {          
            var points = []
            var bounds = new google.maps.LatLngBounds();
            $.each(positions, function(index, position) {
                var latlng = new google.maps.LatLng(position.fields.latitude, position.fields.longitude);
                bounds.extend(latlng);
                points.push(latlng);
            });
            
            var path = new google.maps.Polyline({
                path: points,
                strokeColor: '#ff0000',
                strokeOpacity: 0.6,
                strokeWeight: 6
            });
            
            path.setMap(map);
            map.fitBounds(bounds);
          }
        </script>
    </head>
    <body>
        <div id="info"></div>
        <div id="map" style="width: 100%; height: 100%"></div>
    </body>
</html>

